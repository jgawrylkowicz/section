// TODO fix the position and the placeholder of the avatar image 
// TODO add special classes for elements 
// TODO Refractor the code
// TODO move topbar into content
// Zooming out causes the topbar and the header display issues   

$line-height: 1.5
$ratio: 1.25
$sidebar-width: 350px

$break-xxs: 360px
$break-xs: 400px
$break-s: 560px
$break-m: 768px
$break-l: 900px
$break-xl: 1200px
$break-xxl: 1600px
$break-xxxl: 2000px
$break-uw: 2600px 

//1600px has to be the maximum for other pages

$step-up-1: 1em * $ratio
$step-up-2: $step-up-1 * $ratio
$step-up-3: $step-up-2 * $ratio
$step-up-4: $step-up-3 * $ratio
$step-down-1: 1em / $ratio
$step-down-2: $step-down-1 / $ratio

$max-card-width: 800px
$card-border-radius: 6px
$background-color: #EDF1F4
$sidebar-background-color: white
$card-background: rgb(255,255,255)
$dark-mode-card: rgba(44,50,58,1)

$post-width: 28.75em
$post-height: 32.875em
$post-padding: 18px

$content-grid-gap: 36px
$content-grid-padding: 1em

$shadow: 0 .5em 2em 0 rgba(50,50,50,0.2)

//@mixin transition 




@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 600
  src: local("Roboto Medium"), url(/fonts/Roboto-Medium.woff) format("tff")


@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 400
  src: local("Roboto Regular"), url(/fonts/Roboto-Regular.woff) format("tff")


@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 300
  src: local("Roboto Light"), url(/fonts/Roboto-Light.woff) format("tff") 


\::-moz-selection, ::selection
  background: rgba(107, 79, 189, 0.4)
  text-shadow: none


::-webkit-scrollbar
  width: 0
  display: none

body
  -moz-osx-font-smoothing: grayscale
  -webkit-font-smoothing: antialiased
  background: $background-color
  background-attachment: fixed
  background-size: cover
  //height: 100vh
  margin: 0
  //width: 100%
  //position: fixed
  //position fixed and height somehow break the performance on safari
  text-rendering: optimizeLegibility

html
  -ms-touch-action: manipulation
  line-height: $line-height
  display: block
  height: 100%
  width: 100%
  touch-action: manipulation
  font-size: 100%

body, html
  font-family: 'Roboto', "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif
  font-weight: 400
  overflow-x: hidden
  font-size: 1em

code
  border: none
  border-bottom-right-radius: 3px
  border-radius: 0
  border-top-right-radius: 3px
  display: block
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace
  font-size: 13px
  line-height: 19px
  overflow: auto
  padding: 0

a
  color: inherit
  text-decoration: none
  
*, :after, :before
  -webkit-box-sizing: border-box
  box-sizing: border-box

h1, h2, h3, h4, h5, h6, ul
  padding-top: 0
  margin-top: 0

h1, h2, h3, h4, h5, h6
  font-weight: 600

h1, h2, h3
  margin-bottom: $step-up-1 .5em
  line-height: 1.2
  margin-left: -2px

ul
  list-style-type: none
  padding: 0
  margin: 0
li
  font-size: 1em

h1
  font-size: $step-up-3

h2
  font-size: $step-up-2

h3
  font-size: $step-up-1

h4
  font-size: 1em

p
  font-weight: 300
  overflow-wrap: break-word
  word-wrap: break-word
  -ms-word-break: break-all
  word-break: break-word
  -ms-hyphens: auto
  -moz-hyphens: auto
  -webkit-hyphens: auto
  hyphens: auto
ul
  line-height: $line-height

// Structure of the site
// contains main and header objects
.layout
  display: grid
  grid-template-rows: 100px 1fr
  width: 100%   
  @media only screen and (min-width: $break-xl)
    grid-template-columns: $sidebar-width 2em 1fr 2em
  @media only screen and (max-width: $break-xl)
    grid-template-columns: 1fr

// Container for the main content 
// Contains one of the classes - articles or posts
.main
  width: 100%
  overflow: visible
  z-index: 1
  grid-row-start: 2
  @media only screen and (min-width: $break-xl)
    grid-column-start: 3
  @media only screen and (max-width: $break-xl)
    grid-column-start: 1
 

// Container for the top information
// fixed for mobile
.tob-bar
  display: flex
  align-items: center 
  z-index: 4000
  width: 100vw
  padding: 0 1em
  position: fixed
  transition: background .15s ease
  height: 4em
  background: #F4F7FA
  box-shadow: $shadow
  @media only screen and (min-width: $break-xl)
    margin-left: $sidebar-width 
    background: none
    box-shadow: none
    height: 100px
    position: relative
    width: 100%
    
// The button for opening the sidebar
.top-bar__button
  font-size: $step-up-3
  justify-self: flex-start
  transition: color .15s ease-in-out
  color: #293C50
  &:hover
    color: #6F64F2
  @media only screen and (min-width: $break-xl)
    display: none !important

.top-bar__text--slash
  color: #E7AAAE
  padding: 0 .5em
.top-bar__text
  text-transform: uppercase
  color: #293C50
  margin: 0
  padding-left: 2.25em

.search
  @media only screen and (max-width: $break-m)
    display: none
  input[type="text"]
    background: #FFFFFF
    box-shadow: 0 2px 40px 0 rgba(0,0,0,0.15)
    border-radius: 3px
    border: none
    height: 2em
    margin-left: 1em
    width: 260px

//The button for closing the sidebar    
.header__close
  margin-top: auto
  @media only screen and (min-width: $break-xl)
    display: none 

// Container for the sidebar
// 3 different versions, depending on the screen width
// desktop, desktop/tablet , mobile 
.header
  vertical-align: middle
  z-index: 1200
  height: 100%
  flex-grow: 1
  display: flex
  overflow-y: hidden
  flex-shrink: 1
  background-color: $sidebar-background-color
  box-shadow: $shadow
  position: fixed
  align-items: flex-start 
  flex-flow: wrap
  flex-direction: column
  left: $sidebar-width - (2 * $sidebar-width)
  width: $sidebar-width
  padding-top: 4em
  @media only screen and (min-width: $break-xl) 
    padding-top: 0
    height: 100vh
    min-height: 100%
    left: 0
  @media only screen and (max-width: $break-xl) 
    @supports (backdrop-filter: blur(3em)) or (-webkit-backdrop-filter: blur(2em))
      background: rgba(255, 255, 255, .8)
      backdrop-filter: blur(2em)
      -webkit-backdrop-filter: blur(2em)

.nav-item
  display: flex
  padding: 1em 2em
  align-items: center
  transition: all .15s ease-in-out
  color: #5F7288
  border-left: 5px solid transparent
  &:hover
    color: #6F64F2
    background: rgba(0,0,0,.05)
    border-left: 5px solid #6F64F2
    .nav_item_icon
      color: #ABA8F2
  &:active
    border-left: 5px solid #E8676A
    background: #FFE6E8

.nav-item__icon
  width: 1em
  color: #AAB9C5
  transition: color .15s ease-in-out
  margin-right: 1em

.nav-item__info
  line-height: .25
  font-size: 1em
  font-weight: 300
  color: #AAB9C5
  position: absolute

.nav-item__label
  text-transform: uppercase
  font-weight: 600

.nav-item--close
  display: flex
  padding: 1em 2em
  align-items: center
  transition: all .15s ease-in-out
  color: #E7AAAE 
  &:hover
    color: #E8676A

// class for hiding the sidebar
.show-header
  -webkit-transition: all .15s ease
  transition: all .15s ease
  @media only screen and (min-width: $break-xl)
    -webkit-transform: translate3d(0,0,0)
    transform: translate3d(0,0,0)
  @media only screen and (max-width: $break-xl)
    -webkit-transform: translate3d($sidebar-width,0,0)
    transform: translate3d($sidebar-width,0,0)

.header__info, .header__about
  padding: 12px 24px   
.header__close, .header__sns, .header__nav
  width: 100%  
  padding: 12px 0

// Short text about the site
.header__about--greeting
  font-size: $step-up-1
  font-weight: 600
  color: #293C50
.header__about--text
  color: #5F7288
  max-height: 7.5em
  transition: all .15s ease
  @media only screen and (max-height: 600px)
    max-height: 0px
    opacity: 0

// top container for the information about the site / user
// contains the avatar and the title objects
.header__info
  width: 100%
  display: flex
  flex-direction: row
  align-items: center
  justify-content: flex-start

.info-title
  padding-left: 12px
  margin: 12px 0

.info-title__author
  color: #6F64F2
  line-height: $line-height
  margin: 0

.info-title__text
  color: #6D757E
  margin: 0

.avatar
  border-radius: 120%
  display: block
  height: auto
  width: 6em
  box-shadow: $shadow

// container for full pages and posts
.full-post
  display: flex
  justify-content: center
  margin: 0 .5em

// container for the recents posts
.posts
  display: grid
  grid-gap: $content-grid-gap
  grid-auto-rows: minmax(auto, 1fr)
  grid-auto-flow: row dense
  padding: $content-grid-padding
  margin-bottom: 4em
  grid-template-columns: 1fr
  @media only screen and (min-width: $break-m) and (max-width: $break-xxl)  
    grid-template-columns: repeat(auto-fit, minmax(22em, 1fr))
  @media only screen and (min-width: $break-xxl) and (max-width: $break-xxxl)
    grid-template-columns: repeat(3,1fr)
  @media only screen and (min-width: $break-xxxl) and (max-width: $break-uw)
    grid-template-columns: repeat(4,1fr)
  @media only screen and (min-width: $break-uw)  
    grid-template-columns: repeat(5,1fr)

.card
  box-sizing: border-box
  display: flex
  flex-direction: column
  overflow: hidden
  position: relative
  background: $card-background
  border-radius: $card-border-radius
  box-shadow: $shadow

.post
  color: white
  width: 100%
  display: inline-block
  position: relative
  //&:hover

.post::after
  width: 100%
  padding-top: 115%
  display: block
  content: ''

// Page 
.article
  width: 100%
  max-width: 950px
  margin-top: 2em
  margin-bottom: 4em
  display: flex
  align-items: center
  overflow: visible

.article__banner, .article 
  animation-duration: .3s
  animation-fill-mode: both
  animation-name: fade-in-up
  animation-timing-function: ease

.article__banner
  position: relative
  width: calc(100% - 2em)
  margin: 0 1em
  margin-top: -20px
  border-radius: $card-border-radius
  z-index: 20
  display: flex
  flex-direction: column
  justify-content: center
  box-shadow: 0 2px 40px 0 rgba(0,0,0,0.15)
  padding: 2em

.article__banner--title, .article__banner--title--thumbnail
  position: relative
  display: flex
  align-items: baseline
  flex-direction: row
  justify-content: space-between
  z-index: 20
  h1
    font-size: $step-up-4
    margin-bottom: 0

.article__banner--title
  color: #293C50
  
.article__banner--title--thumbnail
  color: white

.article__banner--date, .post__header--date
  font-size: 1em
  margin-bottom: 0
  font-weight: 400

.article__banner--tags
  padding-bottom: .5em

.article__banner--footer
  padding-top: .5em

.article__content
  margin-bottom: 100px  
  max-width: 900px  
  padding: calc(20px + 2em)
  p
    margin: 2em 0
  h2
    color: #6F64F2  
  img
    width: 100%
    -webkit-filter: drop-shadow(0 .5em 2em rgba(50, 50, 50, 0.3))
    filter: drop-shadow(0 .5em 2em rgba(50, 50, 50, 0.3))
 
  @media only screen and (max-width: $break-s)
    padding: 1em

.post--container
  display: flex
  flex-direction: column
  padding: $post-padding
  position: absolute
  top: 0
  left: 0
  bottom: 0
  right: 0
  height: 100%
  width: 100%

.post__header, .post__excerpt, .post__header--thumbnail, .post__excerpt--thumbnail
  margin-bottom: .5em
.post__thumbnail
  margin-bottom: .75em

.post__thumbnail
  width: 100%
  height: auto
  -webkit-filter: drop-shadow(0 .5em 2em rgba(50, 50, 50, 0.3))
  filter: drop-shadow(0 .5em 2em rgba(50, 50, 50, 0.3))

.post__header--title
  position: relative
  display: flex
  align-items: baseline
  flex-direction: row
  justify-content: space-between
  z-index: 20
  h1
    margin-bottom: 0

.post__header--tags, .post__header--tags--thumbnail
  display: inline-flex
  height: 1.25em
  overflow: hidden
  font-size: $step-down-1

.post__header
  color: #293C50 
  border-bottom: 1px solid rgba(0,0,0,.2)
      
.post__header--tags, .article__banner--tags
  color: #5F7288
  a:hover
    color: black
 
.post__header--tags--thumbnail, .article__banner--tags--thumbnail
  color: rgba(255,255,255,.7)
  a:hover
    color: white

.post__header--thumbnail
  color: white
  border-bottom: 1px solid rgba(255,255,255,.2)

.post__excerpt, .post__excerpt--thumbnail
  grid-row-start: 3
  color: #293C50 
  p
    margin: 0

.post__excerpt--thumbnail
  -webkit-mask-image: -webkit-linear-gradient(top, white, rgba(255, 255, 255, 1) 70%, rgba(255, 255, 255, 0))
  overflow-y: hidden
  color: white

// container for the posts' buttons 
.post__footer
  align-self: flex-start
  justify-self: flex-end
  margin-top: auto
   

.post__footer--thumbnail
  align-self: flex-start
  justify-self: flex-end
  margin-top: auto

.tags-list
  margin: 0
  padding: 0

.tags-list-item
  a
    -webkit-transition: color .15s ease
    transition: color .15s ease
    text-decoration: none
    text-transform: uppercase
  -webkit-appearance: none
  float: left
  padding-right: .5em
  font-weight: 400
  list-style: none
  margin-left: 0
  padding-left: 0
  text-align: center
  position: relative
  z-index: 4
  
.button, .button--alt, .button--thumbnail, .button--alt--thumbnail
  border-radius: 3px
  display: inline-block
  font-size: 1em
  font-weight: 400
  padding: .7em 1.4em
  margin-right: .5em
  margin-top: .5em
  position: relative
  text-align: center
  text-decoration: none
  text-transform: uppercase
  z-index: 4
  transition: all .15s ease-in-out
  &:hover
    -webkit-transform: translate3d(0, -1px, 0)
    transform: translate3d(0, -1px, 0)
  @media screen and (max-width: $break-m)
    padding: .5em 1em

.button
  background: #ABA8F2
  color: rgba(255,255,255,.9)
  &:hover
    background: #6F64F2
    color: white

.button--thumbnail
  background: rgba(255,255,255,.9)
  color: #ABA8F2
  &:hover
    background: white
    color: #6F64F2
    
.button--alt
  background: #E7AAAE
  color: rgba(255,255,255,.7)
  &:hover
    background: #E8676A
    color: white
  
.button--alt--thumbnail
  color: #ABA8F2
  background: rgba(255,255,255,.8)
  &:hover
    color: #6F64F2
    background: white


// Animations for the content of the main object
.fade-in
  animation-duration: .3s
  animation-fill-mode: both
  animation-delay: .1s
  animation-name: fade-in-up
  animation-timing-function: ease
 
@keyframes fade-in-up 
  from 
    opacity: 0
    -webkit-transform: translate3d(0, 1%, 0)
    transform: translate3d(0, 1%, 0)
  to 
    opacity: 1
    -webkit-transform: none
    transform: none

@keyframes fade-in 
  from 
    opacity: 0
    -webkit-transform: translate3d(0, 0, 0)
    transform: translate3d(0, 0, 0)
  to 
    opacity: 1
    -webkit-transform: none
    transform: none