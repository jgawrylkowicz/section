// TODO fix the position and the placeholder of the avatar image 
// TODO max-witdh for card

$line-height: 1.5
$ratio: 1.28
$sidebar-width: 20em

$break-xxs: 360px
$break-xs: 400px
$break-s: 560px
$break-m: 768px
$break-l: 900px
$break-xl: 1200px
$break-xxl: 1500px

$step-up-1: 1em * $ratio
$step-up-2: $step-up-1 * $ratio
$step-up-3: $step-up-2 * $ratio
$step-up-4: $step-up-3 * $ratio
$step-down-1: 1em / $ratio
$step-down-2: $step-down-1 / $ratio

$max-card-width: 800px
$card-border-radius: 3px
$background-color: #EDF1F4
$sidebar-background-color: white
$card-background: rgb(255,255,255)
$dark-mode-card: rgba(44,50,58,1)

$post-width: 28.75em
$post-height: 32.875em
$post-padding: 5%

$content-grid-gap: 3vw
$content-grid-padding: 1em

$shadow: 0 1em 4em 0 rgba(50,50,50,0.20)



@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 600
  src: local("Roboto Medium"), url(/fonts/Roboto-Medium.woff) format("tff")


@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 400
  src: local("Roboto Regular"), url(/fonts/Roboto-Regular.woff) format("tff")


@font-face
  font-family: 'Roboto'
  font-style: normal
  font-weight: 300
  src: local("Roboto Light"), url(/fonts/Roboto-Light.woff) format("tff") 


\::-moz-selection, ::selection
  background: rgba(107, 79, 189, 0.4)
  text-shadow: none

body
  -moz-osx-font-smoothing: grayscale
  -webkit-font-smoothing: antialiased
  background: $background-color
  background-attachment: fixed
  background-size: cover
  //height: 100vh
  margin: 0
  //width: 100%
  //position: fixed
  //position fixed and height somehow break the performance on safari
  text-rendering: optimizeLegibility

html
  -ms-touch-action: manipulation
  line-height: $line-height
  display: block
  height: 100%
  width: 100%
  touch-action: manipulation

body, html
  font-family: 'Roboto', "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif
  font-weight: 400
  overflow-x: hidden
  font-size: 1em

code
  border: none
  border-bottom-right-radius: 3px
  border-radius: 0
  border-top-right-radius: 3px
  display: block
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace
  font-size: 13px
  line-height: 19px
  overflow: auto
  padding: 0

a
  color: inherit
  text-decoration: none
  

img
  max-width: 100%

*, :after, :before
  -webkit-box-sizing: border-box
  box-sizing: border-box

h1, h2, h3, h4, h5, h6, ul
  &:first-of-type
    padding-top: 0
    margin-top: 0

h1, h2, h3, h4, h5, h6
  font-weight: 600

h1, h2, h3
  margin: $step-up-1 0 .5em
  line-height: 1.2
  margin-left: -2px

ul
  list-style-type: none
  padding: 0
  margin: 0
li
  font-size: 1em
  text-transform: uppercase
  font-weight: 500

h1
  font-size: $step-up-3

h2
  font-size: $step-up-2

h3
  font-size: $step-up-1

h4
  font-size: 1em

p
  font-weight: 400
  overflow-wrap: break-word
  word-wrap: break-word
  -ms-word-break: break-all
  word-break: break-word
  -ms-hyphens: auto
  -moz-hyphens: auto
  -webkit-hyphens: auto
  hyphens: auto
ul
  letter-spacing: 1px
  line-height: $line-height
  font-weight: 600

// Structure of the site
// contains main and header objects
#layout
  display: grid
  grid-template-rows: 100px 1fr
  width: 100%   
  @media only screen and (min-width: $break-xl)
    grid-template-columns: $sidebar-width 3em 1fr
  @media only screen and (max-width: $break-xl)
    grid-template-columns: 1fr

// Container for the main content 
// Contains one of the classes - articles or posts
#main
  width: 100%
  overflow: visible
  z-index: 1
  grid-row-start: 2
  @media only screen and (min-width: $break-xl)
    grid-column-start: 3
  @media only screen and (max-width: $break-xl)
    grid-column-start: 1
 

// Container for the top information
// fixed for mobile
#topbar
  display: flex
  align-items: center 
  z-index: 1000
  height: 100px
  width: 100%
  h3
    text-transform: uppercase
    color: #293C50
    margin: 0
    padding-left: 3.15em
  span.slash
    color: #E7AAAE
    padding: 0 .5em
  @media only screen and (min-width: $break-xl)
    margin-left: $sidebar-width
    i
      display: none
  @media only screen and (max-width: $break-xl)
    padding: 0 1em
    position: fixed
    //background: #F4F7FA
    //box-shadow: 0 2px 40px 0 rgba(0,0,0,0.15)
  @media only screen and (max-width: $break-l)
    h3
      justify-self: center

#search
  @media only screen and (max-width: $break-m)
    display: none

input[type="text"]
  background: #FFFFFF
  box-shadow: 0 2px 40px 0 rgba(0,0,0,0.15)
  border-radius: 3px
  border: none
  height: 2em
  margin-left: 1em
  width: 260px

// The button for opening the sidebar
#menu
  position: fixed
  i
    font-size: $step-up-3
    justify-self: flex-start
    transition: color .3s ease-in-out
    color: #293C50
    -webkit-filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.2))
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.2))
    &:hover
      color: #6F64F2
  @media only screen and (min-width: $break-xl) 
    display: none

//The button for closing the sidebar    
#close
  padding: 0em 2em
  justify-self: flex-end
  font-size: 1em
  margin-top: auto
  margin-bottom: 1em
  a 
    color: #E7AAAE 
    &:hover
      color: #E8676A !important
  i
    margin-right: 1em
    width: 1em
  @media only screen and (min-width: $break-xl)
    display: none 

// Container for the sidebar
// 3 different versions, depending on the screen width
// desktop, desktop/tablet , mobile 
#header
  vertical-align: middle
  z-index: 1200
  height: 100%
  flex-grow: 1
  display: flex
  flex-direction: column
  flex-flow: nowrap
  overflow-wrap: normal
  overflow-y: hidden
  flex-shrink: 1
  flex-wrap: nowrap
  background-color: $sidebar-background-color
  box-shadow: $shadow
  position: fixed
  align-items: flex-start 
 
  @media only screen and (min-width: $break-xl) 
    left: 0
  @media only screen and (min-width: $break-s) and (max-width: $break-xl) 
    left: $sidebar-width - (2 * $sidebar-width)
  @media only screen and (min-width: $break-s)
    width: $sidebar-width
  @media only screen and (max-width: $break-s) 
    width: 80%
    left: -80%
    #info
      justify-content: space-evenly 

  p
    margin: 0
  & > div
    &:first-child
      padding-top: 0
    &:last-child 
      border-bottom: none
      padding-bottom: 0
  a.item
    display: flex
    align-items: center
    transition: color .3s ease
    &:hover
      color: black
  
// class for hiding the sidebar
.show-header
  -webkit-transition: all .3s ease
  transition: all .3s ease
  @media only screen and (min-width: $break-xl)
    -webkit-transform: translate3d(0,0,0)
    transform: translate3d(0,0,0)
  @media only screen and (min-width: $break-s) and (max-width: $break-xl)
    -webkit-transform: translate3d($sidebar-width,0,0)
    transform: translate3d($sidebar-width,0,0)
  @media only screen and (max-width: $break-s) 
    -webkit-transform: translate3d(100%,0,0)
    transform: translate3d(100%,0,0)

#header
  display: flex
  flex-flow: row wrap
  flex-direction: column

#content

// container for full pages and posts
.articles
  display: flex
  justify-content: center
  margin: 0 .5em

// container for the recents posts
.posts
  display: grid
  grid-gap: $content-grid-gap
  grid-template-columns: repeat(auto-fit, minmax(22em, 1fr))
  grid-auto-rows: minmax(auto, 1fr)
  grid-auto-flow: row dense
  padding: $content-grid-padding
  margin-bottom: 4em
  // need to calculate the exact width
  // should be 22em * 2 + 2 * $content-grid-gap
  //@media only screen and (min-width: $break-s) and (max-width: 51em)  
    //grid-template-columns: 4em 1fr 4em
  @media only screen and (max-width: $break-s) 
    grid-template-columns: 1fr

#info
  padding: 0 .75em

#aboutme
  div
    font-size: $step-up-1
    font-weight: 500
    color: #293C50
  p
    color: #5F7288
  h3, h4
    margin: 0
    line-height: $line-height

#navigation, #sns, #aboutme
  padding: 1em 2em


#info
  width: 100%
  display: flex
  flex-direction: row
  background-color: #F4F7FA
  align-items: center
  justify-content: center

#title
  padding-left: .5em
  margin: 2em 0
  h3
    color: #6F64F2
    line-height: $line-height
  p 
    color: #6D757E
  & > *
    margin: 0

#navigation, #sns
  width: 100%
  a
    transition: color .3s ease-in-out
    color: #5F7288
    &:hover
      color: #ABA8F2
      i
        color: #ebebfc
  i 
    width: 1em
    color: #E7EDF3
    transition: color .3s ease-in-out
    margin-right: 1em
  li
    line-height: 2
    padding-bottom: 1.6em
 
  div.info
    line-height: 0
    font-size: $step-down-1
    text-transform: lowercase
    font-weight: 400
    color: #AAB9C5

#avatar
  img
    border-radius: 120%
    display: block
    height: auto
    width: 5em
    margin: auto
    box-shadow: 0 10px 40px 0 rgba(0,0,0,0.20)

.card
  box-sizing: border-box
  display: flex
  flex-direction: column
  overflow: hidden
  position: relative
  background: $card-background
  border-radius: $card-border-radius
  box-shadow: $shadow

.post
  color: white
  width: 100%
  padding-top: 115%
  &:hover
    .post_thumbnail
      //display: none
    .post_content
      // -webkit-transform: translate3d(0, -60%, 0)
      // transform: translate3d(0, -60%, 0)
    .hidden
      //max-height: none
      //height: 17em
 

.article
  width: 100%
  max-width: 50em
  margin-top: 2em
  .post_content
    margin-top: 175px  
    padding-left: calc(20px + 2em)
    padding-right: calc(20px + 2em)
    padding-bottom: calc(20px + 2em)
    h2
      color: #6F64F2  
  

.article_banner
  position: absolute
  width: calc(100% - 4em)
  max-width: 46em
  padding-top: 60%
  border-radius: $card-border-radius
  z-index: 20
  display: flex
  flex-direction: column
  justify-content: center
  box-shadow: 0 2px 40px 0 rgba(0,0,0,0.15)
  padding: 2em
  .post_footer
    padding-top: .5em
    border-top: 1px solid rgba(255,255,255,.7)
  .post_tags
    padding-bottom: .5em
  .article_title
    color: white
    position: relative
    display: flex
    align-items: baseline
    flex-direction: row
    justify-content: space-between
    z-index: 20
    h1
      font-size: $step-up-4
      margin-bottom: 0
    .post_date
      font-size: 1em
      margin-bottom: 0
      font-weight: 400

.card-gradient
  z-index: 3
  &::after
    -webkit-transition: opacity .3s ease
    background-image: -webkit-gradient(linear, left bottom, left top, from(rgba(142, 102, 119, 0.15)), color-stop(90%, rgba(255, 175, 189, 0)))
    background-image: linear-gradient(to top, rgba(142, 102, 119, 0.15) 0%, rgba(255, 175, 189, 0) 90%)
    bottom: 0
    content: ''
    height: 40%
    left: 0
    opacity: .4
    position: absolute
    transition: opacity .3s ease
    width: 100%
    z-index: 2
  &:hover::after
    opacity: 1

.post_container
  display: flex
  flex-direction: column
  position: absolute
  top: 0
  padding: $post-padding
  height: 100%
  width: 100%
  .post_footer
    margin-top: auto
  .post_content
    margin-top: $post-padding
    &.no-thumbnail
      margin-top: 0
      color: #293C50 !important
      .post_tags
        a 
          color: #5F7288 !important

.post_thumbnail
  width: 100%
  img
    height: auto
    vertical-align: middle
    -webkit-filter: drop-shadow(0 2px 16px rgba(0, 0, 0, 0.2))
    filter: drop-shadow(0 2px 16px rgba(0, 0, 0, 0.2))

.post_title
  position: relative
  display: flex
  align-items: baseline
  flex-direction: row
  justify-content: space-between
  z-index: 20
  h1
    margin-bottom: 0
  .post_date
    font-size: 1em
    margin-bottom: 0
    font-weight: 400

.post_tags
  display: inline-flex
  height: 1.25rem
  overflow: hidden
  font-size: $step-down-1

.post_footer
  z-index: 10

.post_excerpt
  border-top: 1px solid rgba(255,255,255,.3)
  &.hidden
    -webkit-mask-image: -webkit-linear-gradient(top, rgba(255,255,255,1), rgba(255,255,255,.8) 80%, rgba(255,255,255,0))
    position: absolute
    overflow-x: hidden

.post_content, .post_title, .post_footer, 
  //animation-duration: .4s
  //animation-fill-mode: both
  //animation-name: fade-in
  //animation-timing-function: ease
  //animation-delay: .2s

.post_content
  position: relative
  z-index: 4
 
  
.tags-list
  margin: 0
  padding: 0

.tags-list-item
  a
    -webkit-transition: color .3s ease
    transition: color .3s ease
    text-decoration: none
    color: rgba(255,255,255,.7)
    text-transform: uppercase
    &:hover
      color: white
  -webkit-appearance: none
  float: left
  padding-right: .5em
  font-weight: 400
  list-style: none
  margin-left: 0
  padding-left: 0
  text-align: center
  position: relative
  z-index: 4


.button-wrapper
  z-index: -1
  margin-left: auto
  &:last-of-type
    padding-bottom: 0

.fade-in
  animation-duration: .4s
  animation-fill-mode: both
  animation-delay: .1s
  animation-name: fade-in-up
  animation-timing-function: ease
 
@keyframes fade-in-up 
  from 
    opacity: 0
    -webkit-transform: translate3d(0, 1%, 0)
    transform: translate3d(0, 1%, 0)
  to 
    opacity: 1
    -webkit-transform: none
    transform: none

@keyframes fade-in 
  from 
    opacity: 0
    -webkit-transform: translate3d(0, 0, 0)
    transform: translate3d(0, 0, 0)
  to 
    opacity: 1
    -webkit-transform: none
    transform: none
  
.button
  background-color: white 
  border-radius: 3px
  color: #5F7288
  display: inline-block
  font-size: 1em
  font-weight: 400
  padding: .7em 1.4em
  margin-right: .5em
  margin-top: .5em
  position: relative
  text-align: center
  text-decoration: none
  text-transform: uppercase
  z-index: 4
  box-shadow: 0 2px 8px 3px rgba(255,255,255,0.10)
  transition: all .3s ease-in-out
  &:hover
    box-shadow: 0 2px 16px 3px rgba(255,255,255,0.2)
    color: #293C50
    -webkit-transform: translate3d(0, -5%, 0)
    transform: translate3d(0, -5%, 0)
  &.alt
    background: rgba(255,255,255,.3)
    color: rgba(255,255,255,.7)
  &.alt:hover
    color: white
  @media screen and (max-width: $break-m)
    padding: .5em 1em


.container
  display:flex
  flex-direction: column
  margin: auto
  justify-content: flex-start
  .item 
    display: flex
    flex-direction: row
    align-items: center
    i
      font-size: $step-up-2
      width: 2em

